---
naftiko: "0.4"
info:
  label: "Tutorial - Step 3b - Forwarding API Resource"
  description: "This is a sample capability specification to demonstrate the features of Naftiko"
  tags:
    - Naftiko
    - Tutorial
  created: "2026-02-26"
  modified: "2026-02-26"
  stakeholders:
    - role: "editor"
      fullName: "Navi"
      email: "navi@naftiko.io"

capability:
  exposes:
    - type: "api"
      address: "localhost"
      port: 9090
      namespace: "sample"
      resources:
        - path: "/notion/pre-release"
          name: "pr"
          label: "Pre-release resource"
          description: "This is a resource to retrieve the list of pre-release participants stored in Notion"
          operations:
            - method: "GET"
              steps:
                - call: "notion.query-db"
                  with:
                    datasource_id: "2fe4adce-3d02-8028-bec8-000bfb5cafa2"
        - path: "/notion/{{path}}"
          forward:
            targetNamespace: notion
            trustedHeaders:
            - Notion-Version

  consumes:
    - type: "http"
      namespace: "notion"
      baseUri: "https://api.notion.com/v1/"
      authentication:
        type: "bearer"
        token: "{{notion_api_key}}"
      inputParameters:
        - name: "notion_api_key"
          in: "environment"
        - name: "Notion-Version"
          in: "header"
          const: "2025-09-03"
      resources:
        - path: "data_sources/{{datasource_id}}/query"
          name: "query"
          label: "Query database resource"
          operations:
            - method: "POST"
              name: "query-db"
              label: "Query Database"
              body: |
                {
                  "filter": {
                    "property": "Participation Status",
                    "select": {
                      "equals": "Committed"
                    }
                  }
                }
