---
naftiko: "0.3"
info:
  label: "Protobuf Test Capability"
  description: "Test capability for Protobuf message decoding from API responses"
  tags:
    - Test
    - Protobuf
  created: "2026-02-21"
  modified: "2026-02-21"

capability:
  exposes:
    - type: "api"
      address: "localhost"
      port: 9092
      namespace: "test-protobuf"

      resources:
        - path: "/proto/records"
          name: "records"
          label: "Protobuf Records Resource"
          description: "Test resource that parses Protobuf messages"
          operations:
            - method: "GET"
              call:
                operation: "mock-proto.get-records"
              outputParameters:
                - type: "array"
                  mapping: "$.records"
                  items:
                    - type: "object"
                      properties:
                        id:
                          type: "string"
                          mapping: "$.id"
                        title:
                          type: "string"
                          mapping: "$.title"
                        description:
                          type: "string"
                          mapping: "$.description"

  consumes:
    - type: "http"
      namespace: "mock-proto"
      baseUri: "http://localhost:8080/"
      inputParameters:
        - name: "Accept"
          in: "header"
          const: "application/protobuf"

      resources:
        - path: "api/records"
          name: "records"
          label: "Mock Records API"
          operations:
            - method: "GET"
              name: "get-records"
              label: "Get Records"
              outputRawFormat: "Protobuf"
              outputSchema: "schemas/test-records.proto"
