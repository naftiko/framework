---
naftiko: "0.3"
info:
  label: "CSV Test Capability"
  description: "Test capability for CSV parsing from API responses"
  tags:
    - Test
    - CSV
  created: "2026-02-21"
  modified: "2026-02-21"

capability:
  exposes:
    - type: "api"
      address: "localhost"
      port: 9092
      namespace: "test-csv"

      resources:
        - path: "/csv/users"
          name: "users"
          label: "CSV Users Resource"
          description: "Test resource that parses CSV responses"
          operations:
            - method: "GET"
              call:
                operation: "mock-csv.get-users"
              outputParameters:
                - type: "array"
                  mapping: "$"
                  items:
                    - type: "object"
                      properties:
                        id:
                          type: "string"
                          mapping: "$.id"
                        name:
                          type: "string"
                          mapping: "$.name"
                        email:
                          type: "string"
                          mapping: "$.email"

  consumes:
    - type: "http"
      namespace: "mock-csv"
      baseUri: "http://localhost:8080/"
      inputParameters:
        - name: "User-Agent"
          in: "header"
          const: "Naftiko/0.3"

      resources:
        - path: "api/users"
          name: "users"
          label: "Mock Users API"
          operations:
            - method: "GET"
              name: "get-users"
              label: "Get Users"
              outputRawFormat: "CSV"
